<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta http-equiv="Content-Language" content="ru">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>(.exe) Segmented (New) .EXE File Header Format (NE)</title>
</head>
<body background="images/background_item.gif"><!--'"</title></head>-->
<script type="text/javascript">
////// Compete /////////////////////
__compete_code = '667f89f26d96c30e99728fe6a608804d';
(function () {
    var s = document.createElement('script'),
        d = document.getElementsByTagName('head')[0] ||
            document.getElementsByTagName('body')[0],
        t = 'https:' == document.location.protocol ? 
            'https://c.compete.com/bootstrap/' : 
            'http://c.compete.com/bootstrap/';
    s.src = t + __compete_code + '/bootstrap.js';
    s.type = 'text/javascript';
    s.async = 'async'; 
    if (d) { d.appendChild(s); }
})();


////// Quantcast  /////////////////////
function channValidator(chann) {
    return (typeof(chann) == 'string' && chann != '');
}

function lycosQuantcast(){
    var lb = "";
    if(typeof(cm_host) !== 'undefined' && channValidator(cm_host)){
        lb += cm_host.split('.')[0] + '.';
    }

    if(typeof(cm_taxid) !== 'undefined' && channValidator(cm_taxid)){
        lb += cm_taxid;
        lb = lb.replace('/','');
    } else {
        lb = lb.replace('.','');
    }
    return lb;
}

var _qevents = _qevents || [];

(function() {
    var elem = document.createElement('script');
    elem.src = (document.location.protocol == "https:" ? "https://secure" :"http://edge") + ".quantserve.com/quant.js";
    elem.async = true;
    elem.type = "text/javascript";
    var scpt = document.getElementsByTagName('script')[0];
    scpt.parentNode.insertBefore(elem, scpt);
})();

_qevents.push({
    qacct:"p-6eQegedn62bSo",
    labels:lycosQuantcast()
});

////// OwnerIQ  /////////////////////
var __oiq_pct = 50;
if( __oiq_pct>=100 || Math.floor(Math.random()*100/(100-__oiq_pct)) > 0 ) {
    var _oiqq = _oiqq || [];
    _oiqq.push(['oiq_addPageBrand', 'Lycos']);
    _oiqq.push(['oiq_addPageCat', 'Internet > Websites']);
    _oiqq.push(['oiq_addPageLifecycle', 'Intend']);
    _oiqq.push(['oiq_doTag']);

    (function() {
        var oiq = document.createElement('script'); oiq.type = 'text/javascript'; oiq.async = true;
        oiq.src = document.location.protocol + '//px.owneriq.net/stas/s/lycosn.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(oiq, s);
    })();
}



/////// Google Analytics ////////////
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-21402695-19']);
_gaq.push(['_setDomainName', 'tripod.com']);
_gaq.push(['_setCustomVar', 1, 'member_name', 'faydoc', 3]);
_gaq.push(['_trackPageview']);
(function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();


/////// Lycos Initialization ////////////
function getReferrer() {
    // Reads the referrer out of the cookie, if available.
    var all= this.document.cookie;
    if (all== '') return false;
    var cookie_name = 'REFERRER=';
    var start = all.lastIndexOf(cookie_name);
    if (start == -1) return false;  // referrer URL not found.
    start += cookie_name.length;
    var end = all.indexOf(';', start);
    if (end == -1) end = all.length;
    return all.substring(start, end);
}
function getQuery() {
    // Get the referrer search query from cookie, if available.
    var rfr = getReferrer();
    if (rfr == '') return false;
    var q = extractQuery(rfr, 'yahoo.com', 'p=');
    if (q) return q;
    q = extractQuery(rfr, '', 'q=');
    return q ? q : "";
}
function extractQuery(full, site, q_param) {
    var start = full.lastIndexOf(site);
    if (start == -1) return false;
    start = full.lastIndexOf(q_param);
    if (start == -1) return false;
    start += q_param.length;
    var end = full.indexOf('&', start);
    if (end == -1) end = full.length;
    return unescape(full.substring(start, end)).split(" ").join("+");
}

function generateHref(atag, template){
    atag.href=template.replace('_MYURL_', window.location.href.replace('http://', '')).replace('_MYTITLE_', 'Check%20out%20this%20Tripod%20Member%20site!'); 
}


var lycos_ad = Array();
var lycos_onload_timer;

var cm_role = "live";
var cm_host = "tripod.lycos.com";
var cm_taxid = "/memberembedded";
var tripod_member_name = "faydoc";
var tripod_member_page = "faydoc/formats/exe-NE.htm";
var tripod_ratings_hash = "1372261284:ee869defa711bf4ec4016ac6f8449872";

var lycos_ad_category = {"find_what":"reliv.com"};

var lycos_ad_remote_addr = "99.159.74.223";
var lycos_ad_www_server = "www.tripod.lycos.com";
var lycos_ad_track_small = "http://members.tripod.com/adm/img/common/ot_smallframe.gif?rand=836645";
var lycos_ad_track_served = "http://members.tripod.com/adm/img/common/ot_adserved.gif?rand=836645";
var lycos_search_query = getQuery();


////// Criteo /////////////////////
var cto_conf = { a:true, i: "294", c:"img", kw: "" } ;
(function (){
    var c = document.createElement("script"); c.type = "text/javascript"; c.async = true;
    c.src = "http://members.tripod.com/adm/partner/criteo_ld_kw.js";
    var s = document.getElementsByTagName("body")[0]; s.appendChild(c);
})(); 

</script>

<script type="text/javascript" src="http://scripts.lycos.com/catman/init.js"></script>
<script type="text/javascript"> 

(function(isV) {
    if (!isV) {
        return;
    }

    //this.lycos_search_query = lycos_get_search_referrer();
    var adMgr = new AdManager();
    var lycos_prod_set = adMgr.chooseProductSet();
    var slots = ["leaderboard", "leaderboard2", "toolbar_image", "toolbar_text", "smallbox", "top_promo", "footer2"];
    var adCat = this.lycos_ad_category;
    adMgr.setForcedParam('page', (adCat && adCat.dmoz) ? adCat.dmoz : 'member');

    if (this.lycos_search_query) {
        adMgr.setForcedParam("keyword", this.lycos_search_query);
    } 
    else if (adCat && adCat.find_what) {
        adMgr.setForcedParam('keyword', adCat.find_what);
    }

    for (var s in slots) {
        var slot = slots[s];
        if (adMgr.isSlotAvailable(slot)) {
            this.lycos_ad[slot] = adMgr.getSlot(slot);
        }
    }

    adMgr.renderHeader();
    adMgr.renderFooter();
}((function() {
    var w = 0, h = 0, minimumThreshold = 300;
    if (top == self) {
        return true;
    }

    if (typeof(window.innerWidth) == 'number' ) {
        w = window.innerWidth;
        h = window.innerHeight;
    }
    else if (document.documentElement && (document.documentElement.clientWidth || document.documentElement.clientHeight)) {
        w = document.documentElement.clientWidth;
        h = document.documentElement.clientHeight;
    }
    else if (document.body && (document.body.clientWidth || document.body.clientHeight)) {
        w = document.body.clientWidth;
        h = document.body.clientHeight;
    }

    return ((w > minimumThreshold) && (h > minimumThreshold));
}())));
    
window.onload = function() {
    var f = document.getElementById("FooterAd");
    var b = document.getElementsByTagName("body")[0];
    b.appendChild(f);
    f.style.display = "block";
    document.getElementById('lycosFooterAdiFrame').src = '/adm/ad/footerAd.iframe.html';


    // DOM Injection Ad
    (function(isTrellix) {
        var e = document.createElement('iframe');
        e.style.border = '0';
        e.style.margin = 0;
        e.style.display = 'block';
        e.style.cssFloat = 'right';
        e.style.height = '254px';
        e.style.overflow = 'hidden';
        e.style.padding = 0;
        e.style.width = '300px';

        var getCommentNodes = function(regexPattern) {
            var nodes = {};
            var nodesA = [];
            var preferredNodesList = ['a', 'c', 'b'];

            (function getNodesThatHaveComments(n, pattern) {
                if (n.hasChildNodes()) {
                    if (n.tagName === 'IFRAME') {
                        return false;
                    }
                    for (var i = 0; i < n.childNodes.length; i++) {
                        if ((n.childNodes[i].nodeType === 8) && (pattern.test(n.childNodes[i].nodeValue))) {
                            var areaName = pattern.exec(n.childNodes[i].nodeValue)[1];
                            nodes[areaName] = n;
                        }
                        else if (n.childNodes[i].nodeType === 1) {
                            getNodesThatHaveComments(n.childNodes[i], pattern);
                        }
                    }
                }
            }(document.body, regexPattern));

            for (var i in preferredNodesList) {
                if (nodes[preferredNodesList[i]]) {
                    if (nodes[preferredNodesList[i]].parentNode.parentNode.parentNode.parentNode) {
                        nodesA.push(nodes[preferredNodesList[i]].parentNode.parentNode.parentNode.parentNode);
                    }
                }
            }

            return nodesA;
        }

        var properNode = null;
        var areaNodes = getCommentNodes(new RegExp('^area Type="area_(\\w+)"'));
        for (var i = 0; i < areaNodes.length; i++) {
            var a = parseInt(getComputedStyle(areaNodes[i]).width);
            if ((a >= 300) && (a <= 400)) {
                properNode = areaNodes[i];
                break;
            }
        }

        if ((isTrellix) && (properNode)) {
            e.src = '/adm/ad/injectAd.iframe.html';
            properNode.insertBefore(e, properNode.firstChild);
        }
        else {
            e.src = '/adm/ad/sliderAd.iframe.html';
            var sliderBlock = document.getElementById('lyslider-adblock-wrapper');
            var sliderHolder = document.getElementById('lyslider-adblock-holder');
            var sliderClose = document.getElementById('lyslider-adblock-close');
            sliderBlock.style.display = 'block';

            sliderClose.onclick = function() {
                sliderBlock.parentNode.removeChild(sliderBlock);
                return false;
            }

            var iframeOnload = function() {
                setTimeout((function sliiide() {
                    var s = (window.getComputedStyle) ? parseInt(getComputedStyle(sliderHolder).right) : parseInt(sliderHolder.currentStyle.right);
                    if (s <= 0) {
                        sliderHolder.style.right = (s + 6) + 'px';
                        setTimeout(sliiide, 10);
                    }
                    else {
                        sliderHolder.style.right = '0px';
                        sliderClose.style.display = 'block';
                    }
                }), 1000);
            }

            if (e.attachEvent) {
                e.attachEvent('onload', iframeOnload);
            }
            else {
                e.addEventListener('load', iframeOnload, false);
            }

            sliderHolder.insertBefore(e, sliderHolder.firstChild);
        }
    }(document.isTrellix));

}



</script>
<style>
	#body .adCenterClass{margin:0 auto}
</style>

<div id="tb_container" style="background:#DFDCCF; border-bottom:1px solid #393939; position:relative; z-index:999999999!important">
    <div id="tb_ad" class="adCenterClass" style="display:block!important; overflow:hidden; width:916px;">
    <a href="http://adtrack.ministerial5.com/clicknew/?a=637394" title="build your own website at Tripod.com" style="float:left; width:186px; border:0">
    	<img src="http://ly.lygo.com/ly/tpSite/images/freeAd2.jpg" alt="Make your own free website on Tripod.com" style="border:0; display:block" />
    </a> 
        <div id="ad_container" style="display:block!important; float:left; width:728px ">
        <script type="text/javascript">document.write(lycos_ad['leaderboard']);</script>
        </div>
    </div>
</div>

<!-- ///////////////////////////////////// -->
<div id="lyslider-adblock-wrapper" style="display:none; height:300px; overflow:hidden; position:absolute; right:0; top:150px; width:320px; z-index:99999999; ">
<div id="lyslider-adblock-holder" style="background-color:#888; height:250px; margin-bottom:25px; padding:4px; position:absolute; right:-320px; top:10px; width:300px; ">
<a id="lyslider-adblock-close" href="#" style="background-color:#222; bottom:-19px; color:#fff; display:block; font:10px Arial, Helvetica, Sans-serif; padding:4px; position:absolute; right:0; text-decoration:none; z-index:9999999999">Close Ad</a>
</div>
</div>


<div id="FooterAd" style="background:#DFDCCF; border-top:1px solid #393939; clear:both; display:none; width:100%!important; position:relative; z-index:999999!important; height:90px!important"> 
	<div class="adCenterClass" style="display:block!important; overflow:hidden; width:916px;">
	<a href="http://adtrack.ministerial5.com/clicknew/?a=637394" title="build your own website at Tripod.com" style="float:left; display:block; width:186px; border:0">
    	<img src="http://ly.lygo.com/ly/tpSite/images/freeAd2.jpg" alt="Make your own free website on Tripod.com" style="border:0; display:block; " />
    </a> 
        <div id="footerAd_container" style="display:block!important; float:left; width:728px">
        <iframe id="lycosFooterAdiFrame" style="border:0; display:block; float:left; height:96px; overflow:hidden; padding:0; width:750px"></iframe>
        <!-- <script type="text/javascript">document.write(lycos_ad['leaderboard2']);</script> -->
        </div>
	</div>
</div>
<noscript>
 <img src="http://members.tripod.com/adm/img/common/ot_noscript.gif?rand=836645" alt="" width="1" height="1" />
 <!-- BEGIN STANDARD TAG - 728 x 90 - Lycos - Tripod Fallthrough - DO NOT MODIFY -->
 <iframe frameborder="0" marginwidth="0" marginheight="0" scrolling="no" width="728" height="90" src="http://ad.yieldmanager.com/st?ad_type=iframe&amp;ad_size=728x90&amp;section=209094"></iframe>
 <!-- END TAG -->
</noscript>

<!-- Start Ybrant -->
<img src="http://ad.yieldmanager.com/pixel?id=1901600&t=2" width="1" height="1" />
<!--   End Ybrant -->

<!-- Start Datonics -->
<script type="text/javascript" src="http://ads.pro-market.net/ads/scripts/site-132783.js"></script>
<!--   End Datonics -->

<!-- Start Chango -->
<script type="text/javascript">
    var __cho__ = {"pid":1694};
    (function() {
        var c = document.createElement('script');
        c.type = 'text/javascript';
        c.async = true;
        c.src = document.location.protocol + '//cc.chango.com/static/o.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(c, s);
    })();
</script>
<!--   End Chango -->


<table border=3 cellpadding=10 cellspacing=5>
<tr>
<td>
<!--webbot bot="Navigation" S-Type="global" S-Orientation="horizontal"
S-Rendering="graphics" B-Include-Home="FALSE" B-Include-Up="TRUE" U-Page="/W:/doc/formats/exe-NE.htm"
S-Target startspan --><nobr>[&nbsp;<a href="index.htm" target="">Up</a>&nbsp;]</nobr> <nobr>[&nbsp;<a href="http://www.fay.naverex.kiev.ua/docs/index.htm" target="">Docs&nbsp;Home</a>&nbsp;]</nobr><!--webbot bot="Navigation" endspan i-checksum="63939" -->
</td>
<td>
<h1 align="center"><!--webbot bot="Navigation" S-Type="banner"
S-Rendering="graphics" S-Orientation B-Include-Home B-Include-Up U-Page="/W:/doc/formats/exe-NE.htm" S-Target startspan
-->(.exe) Segmented (New) .EXE File Header Format (NE)<!--webbot bot="Navigation" endspan i-checksum="47340"
-->
</h1>
</td>
<td><!--webbot bot="Navigation" S-Type="arrows" S-Orientation="horizontal"
  S-Rendering="graphics" B-Include-Home="FALSE" B-Include-Up="FALSE" U-Page="/W:/doc/formats/exe-NE.htm"
  S-Target startspan --><nobr>[&nbsp;<a href="exe-DOS.htm" target="">Back</a>&nbsp;]</nobr> <nobr>[&nbsp;<a href="exe-LE.htm" target="">Next</a>&nbsp;]</nobr><!--webbot bot="Navigation" endspan i-checksum="26253" -->
</td>
</tr>
</table>
<p>Microsoft Windows требует больше данных о файле, нежели
содержится в формате .EXE executable file для MS-DOS.
Например, Windows нуждается в указании различных
сегментов программы как сегментов кода и данных,
импортированных функций, и сохранении ресурсов
программы (икон, курсоров, меню и др.). Windows
должна также поддерживать dynamically linkable library modules
содержащие процедуры, доступные другим модулям. Из этих
соображений Windows использует
expanded .EXE header format называемый New Executable file header. Он
используется программами Windows, Windows library modules, и resource-only
файлами подобно Windows font resource files.
</p>
<h2>The Old Executable Header
</h2>
<p>New Executable file header включает сущетвующий <a href="exe-DOS.htm"> MS-DOS exe file
header</a>.<br>
Фактически начало New Executable это обычный MS-DOS .EXE header. 4 байта<br>
по смещению 3CH указывают на New Executable header.
</p>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td><b> Length (bytes)</b></td>
<td><b> Contents</b></td>
</tr>
<tr>
<td><b>00H</b></td>
<td align=center>2</td>
<td>сигнатура MZ</td>
</tr>
<tr>
<td><b>3CH</b></td>
<td align=center>4</td>
<td> Offset of New Executable header from beginning of file</td>
</tr>
</table>
<p>В этом MS-DOS .EXE может быть информация о non-Windows MS-DOS program,
которая хранится в .EXE file наряду с Windows program. Эта
программа запускается когда программа стартует
из MS-DOS command line. Большинство Windows programmers используют
стандартную программу, которая пишет &quot;This program requires
Microsoft Windows&quot;.
</p>
<h2>The New Executable Header
</h2>
<p>Начало New Executable file header содержит данные о расположении
и длине разных таблиц. (Смещения от New Executable
header.)
</p>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td><b> Length (bytes)</b></td>
<td><b> Contents</b></td>
</tr>
<tr>
<td><b>00H</b></td>
<td align=center>2</td>
<td>сигнатура NE</td>
</tr>
<tr>
<td><b>02H</b></td>
<td align=center>2</td>
<td> LINK version number : LINK revision number</td>
</tr>
<tr>
<td><b>04H</b></td>
<td align=center>2</td>
<td> смещение entry table от New Executable header</td>
</tr>
<tr>
<td><b>06H</b></td>
<td align=center>2</td>
<td> длина entry table</td>
</tr>
<tr>
<td><b>08H</b></td>
<td align=center>4</td>
<td> 32-bit checksum contents of file, using zero for these 4 bytes</td>
</tr>
<tr>
<td><b>0CH</b></td>
<td align=center>2</td>
<td> Module flag word (see below)</td>
</tr>
<tr>
<td><b>0EH</b></td>
<td align=center>2</td>
<td> Segment number of automatic data segment (0 if neither SINGLEDATA nor MULTIPLEDATA flag is set in flag
word)</td>
</tr>
<tr>
<td><b>10H</b></td>
<td align=center>2</td>
<td> Initial size of local heap to be added to automatic data segment (0 if there is no local
heap)</td>
</tr>
<tr>
<td><b>12H</b></td>
<td align=center>2</td>
<td> Initial size of stack to be added to automatic data segment (0 for library
modules)</td>
</tr>
<tr>
<td><b>14H</b></td>
<td align=center>2</td>
<td> Initial value of instruction pointer (IP) register on entry to program</td>
</tr>
<tr>
<td><b>16H</b></td>
<td align=center>2</td>
<td> Initial segment number for setting code segment (CS) register on entry to
program</td>
</tr>
<tr>
<td><b>18H</b></td>
<td align=center>2</td>
<td> Initial value of stack pointer (SP) register on entry to program (0 if stack
segment is automatic data segment; stack should be set above static data area and
below local heap in automatic data segment)</td>
</tr>
<tr>
<td><b>1AH</b></td>
<td align=center>2</td>
<td> Segment number for setting stack segment (SS) register on entry to program (0 for library
modules)</td>
</tr>
<tr>
<td><b>1CH</b></td>
<td align=center>2</td>
<td> Number of entries in segment table</td>
</tr>
<tr>
<td><b>1EH</b></td>
<td align=center>2</td>
<td> Number of entries in module reference table</td>
</tr>
<tr>
<td><b>20H</b></td>
<td align=center>2</td>
<td> Number of bytes in nonresident names table</td>
</tr>
<tr>
<td><b>22H</b></td>
<td align=center>2</td>
<td> Offset of beginning of segment table relative to beginning of New Executable header</td>
</tr>
<tr>
<td><b>24H</b></td>
<td align=center>2</td>
<td> Offset of beginning of resource table relative to beginning of New Executable header</td>
</tr>
<tr>
<td><b>26H</b></td>
<td align=center>2</td>
<td> Offset of beginning of resident names table relative to beginning of New Executable header</td>
</tr>
<tr>
<td><b>28H</b></td>
<td align=center>2</td>
<td> Offset of beginning of module reference table relative to beginning of New Executable header</td>
</tr>
<tr>
<td><b>2AH</b></td>
<td align=center>2</td>
<td> Offset of beginning of imported names table relative to beginning of New Executable header</td>
</tr>
<tr>
<td><b>2CH</b></td>
<td align=center>2</td>
<td> Offset of nonresident names table relative to beginning of file</td>
</tr>
<tr>
<td><b>30H</b></td>
<td align=center>2</td>
<td> Number of movable entry points listed in entry table</td>
</tr>
<tr>
<td><b>32H</b></td>
<td align=center>2</td>
<td> Alignment shift count (0 is equivalent to 9)</td>
</tr>
<tr>
<td><b>34H</b></td>
<td align=center>12</td>
<td> Reserved for expansion</td>
</tr>
</table>
<p>The module flag word at offset 0CH in the New Executable header is defined as shown in Figure K-1.<br>
<img border=0 src="images/exe1.gif" width=735 height=394><br>
<b>
Figure K-1. The module flag word.</b></p>
<h2>The segment table</h2>
<p>Эта таблица содержит 8-byte record для каждого сегмента кода и данных
программы или библиотеки. Каждый сегмент имеет
ассоциированный с ним номер. Например, первый
имеет номер 1. Эти номера используются для ссылок на сегмент
из других секций New Executable file.</p>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td><b> Length (bytes)</b></td>
<td><b> Contents</b></td>
</tr>
<tr>
<td><b>00H</b></td>
<td align=center>2</td>
<td> Offset of segment relative to beginning of file after shifting value left by alignment shift count</td>
</tr>
<tr>
<td><b>02H</b></td>
<td align=center>2</td>
<td> Length of segment (0000H for segment of 65536 bytes)</td>
</tr>
<tr>
<td><b>04H</b></td>
<td align=center>2</td>
<td> Segment flag word (see below)</td>
</tr>
<tr>
<td><b>06H</b></td>
<td align=center>2</td>
<td> Minimum allocation size for segment; that is, amount of space Windows reserves in memory for segment (0000H for min allocation size of 65536
bytes)</td>
</tr>
</table>
<p><img border=0 src="images/exe2.gif" width=770 height=605><br>
<b>
Figure K-2. The segment flag word.</b></p>
<p>Ресурсы - это сегменты, содержащие данные, но не входящие в обычные сегменты
данных программы. Они используются для хранения
menu, dialog-box templates, icons, cursors, и текстовых стpок, а также любого типа R/O
data. Всякий ресурс имеет тип и имя, оба могут представляться
числом или ASCII name.<br>
<br>
Таблица ресурсов начинается с resource shift count, нужного для
настройки остальных значений в таблице. Вслед за ним находятся одна и более
групп ресурсов, каждая описывает один или несколько
ресурсов.</p>
<b>Начало таблицы</b>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td><b> Length (bytes)</b></td>
<td><b> Contents</b></td>
</tr>
<tr>
<td>00H</td>
<td align=center>2</td>
<td> Resource shift count</td>
</tr>
</table>
<br>
<b>Описание группы ресурсов</b>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td align=center><b> Length (bytes)</b></td>
<td><b> Contents</b>
</td>
</tr>
<tr>
<td>00H</td>
<td align=center>2</td>
<td>
тип ресурса, 0 если конец таблицы, если
старший бит установлен, то тип соответствует
предопределенным номерам (без старшего бита):
<table border=0 cellpadding=5 cellspacing=0>
<tr>
<td>1</td>
<td> Cursor</td>
</tr>
<tr>
<td>2</td>
<td> Bitmap</td>
</tr>
<tr>
<td>3</td>
<td> Icon</td>
</tr>
<tr>
<td>4</td>
<td> Menu template</td>
</tr>
<tr>
<td>5</td>
<td> Dialog-box template</td>
</tr>
<tr>
<td>6</td>
<td> String table</td>
</tr>
<tr>
<td>7</td>
<td> Font directory</td>
</tr>
<tr>
<td>8</td>
<td> Font</td>
</tr>
<tr>
<td>9</td>
<td> Keyboard-accelerator table</td>
</tr>
</table>
<br>
Если старший бит type сброшен, то type определяется
строкой ASCII,
находящейся на расстоянии type от таблицы ресурсов: пеpвый байт-
длина строки PASCAL-style
</td>
</tr>
<tr>
<td>
02H</td>
<td align=center>2</td>
<td> Number of resources of this type
</td>
</tr>
<tr>
<td>
04H</td>
<td align=center>4</td>
<td> Reserved for run-time use
</td>
</tr>
<tr>
<td>
08H</td>
<td align=center>12</td>
<td> each Resource description
</td>
</tr>
</table>
<b><br>
Описание ресурса конкретной группы</b>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td><b> Length (bytes)</b></td>
<td><b> Contents</b></td>
</tr>
<tr>
<td>00H</td>
<td align=center>2</td>
<td> Offset of resource relative to beginning
of file after shifting left by resource shift count</td>
</tr>
<tr>
<td>
02H</td>
<td align=center>2</td>
<td> Length of resource after shifting left by
resource shift count</td>
</tr>
<tr>
<td>
04H</td>
<td align=center>2</td>
<td> Resource flag word (see below)</td>
</tr>
<tr>
<td>
06H</td>
<td align=center>2</td>
<td> Resource name<br>
If high bit set, represented by a number; otherwise, type is ASCII text string and this value is offset from beginning
of resource table, pointing to 1-byte value with number of bytes in string
followed by string itself.</td>
</tr>
<tr>
<td>
08H</td>
<td align=center>4</td>
<td> Reserved for run-time use</td>
</tr>
</table>
<p><img border=0 src="images/exe3.gif" width=774 height=370><br>
<b>Figure K-3. The resource flag word.</b></p>
<h2>The resident names table</h2>
<p>Содержит список строк ASCII. Первая -имя модуля, заданное в module definition
file. Другие строки - имена всех exported functions перечисленных
в module definition file that were not given explicit ordinal numbers or that were
explicitly specified in the file as resident names. (Exported functions with explicit ordinal numbers in the module definition file are listed in the
nonresident names table.)</p>
<p>В начале каждой строки идет байт (ее длина), а в конце два байта (слово)
ссылаются на элемент entry table, начиная с 1. Слово после module name
равно 0.</p>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td><b> Length (bytes)</b></td>
<td><b> Contents</b></td>
</tr>
<tr>
<td>00H</td>
<td align=center>1</td>
<td> Number of bytes in string (0 if end of table)</td>
</tr>
<tr>
<td>01H</td>
<td align=center>n</td>
<td> ASCII string, not null-terminated</td>
</tr>
<tr>
<td>n + 1</td>
<td align=center>2</td>
<td> Index into entry table</td>
</tr>
</table>
<h2> The module reference table</h2>
<p>Таблица содержит по 2 байта на каждый внешний модуль, используемый
программой, 2 байта являются смещением в imported names
table.</p>
<h2> The imported names table</h2>
<p>Imported names table содержит список строк ASCII. Они являются именами
всех других модулей, указываемых (referenced) посредством
imported functions. Строки начинаются байтом длины.<br>
<br>
Большинство приложений Windows содержат в imported names table имена
KERNEL, USER, и GDI, но могут также входить имена других
модулей, таких как KEYBOARD и SOUND. (Смещения от начала записи.)</p>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td><b> Length (bytes)</b></td>
<td><b> Contents</b></td>
</tr>
<tr>
<td>00H</td>
<td align=center>1</td>
<td> длина имени</td>
</tr>
<tr>
<td>01H</td>
<td align=center>n</td>
<td> ASCII стpока, не кончается \0</td>
</tr>
</table>
<p>Стpоки необязательно начинаются в начале imported names
table; the names are referenced by offsets specified in the module reference
table.</p>
<h2>The entry table</h2>
<p>Эта таблица содержит одну запись для каждой точки входа, т.е. всякой public
FAR function или procedure. Записи имеют номера начиная с 1. Эти
номера используются таблицами резидентных и
нерезидентных имен. LINK versions 4.0 and later группирует
(bundle) точки входа. Каждая группа снабжается заголовком:</p>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td><b> Length (bytes)</b></td>
<td><b> Contents</b></td>
</tr>
<tr>
<td>00H</td>
<td align=center>1</td>
<td> количество точек входа в связке (0 если конец таблицы)</td>
</tr>
<tr>
<td>01H</td>
<td align=center>1</td>
<td> Segment number of entry if entry in bundle are in single fixed segment;</td>
</tr>
</table>
<p>0FFH if entry points in bundle are in movable segments Внимание! если
номер сегмента =0, то это Null Entry, нужно только увеличить
очередной номер точки входа и прочесть заголовок следующей связки<br>
<br>
Для связки, содеpжащей entry points in fixed segments, каждая точка входа
тpебует 3 байта:</p>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td><b> Length (bytes)</b></td>
<td><b> Contents</b></td>
</tr>
<tr>
<td>00H</td>
<td align=center>1</td>
<td> Entry-point flag byte (see below)</td>
</tr>
<tr>
<td>01H</td>
<td align=center>2</td>
<td> Offset of entry point in segment</td>
</tr>
</table>
<p>Для связки, содеpжащей entry points in movable segments, каждая точка входа
тpебует 6 байт:</p>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td><b> Length (bytes)</b></td>
<td><b> Contents</b></td>
</tr>
<tr>
<td>00H</td>
<td align=center>1</td>
<td> Entry-point flag byte (see below)</td>
</tr>
<tr>
<td>01H</td>
<td align=center>2</td>
<td> Interrupt 3FH instruction: CDH 3FH</td>
</tr>
<tr>
<td>03H</td>
<td align=center>1</td>
<td> Segment number of entry point</td>
</tr>
<tr>
<td>04H</td>
<td align=center>2</td>
<td> Offset of entry-point segment</td>
</tr>
</table>
<p>The entry-point flag byte is defined as shown in Figure K-4.<br>
<img border=0 src="images/exe4.gif" width=481 height=234><br>
<b>Figure K-4. The entry-point flag.</b></p>
<h2>The nonresident names table</h2>
<p>Эта таблица содержит список строк ASCII.
Первая - описание модуля из module definition file. Остальные
строки являются именами всех exported functions перечисленных
в module definition file, котоpые имеют номера, ассоциированные
с ними. (Exported functions без номеров в module definition file
перечислены в resident names table.)<br>
<br>
Каждая строка начинается байтом-длиной строки
и завершается словом (2 байта) referencing a member of the entry table, beginning at 1. За
строкой module description следует 0.</p>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td><b> Length (bytes)</b></td>
<td><b> Contents</b></td>
</tr>
<tr>
<td>00H</td>
<td align=center>1</td>
<td> Number of bytes in string (0 if end of table)</td>
</tr>
<tr>
<td>01H</td>
<td align=center> n</td>
<td> ASCII string, not null-terminated</td>
</tr>
<tr>
<td>n + 1</td>
<td align=center>2</td>
<td> Index into entry table</td>
</tr>
</table>
<h2>The code and data segment</h2>
<p>Вслед за различными таблицами заголовка New Executable
расположены сегменты кода и данных программы
или библиотечного модуля. Если в слове описания
сегмента он помечен как ITERATED, то его организация
следующая. (Смещения указаны от начала сегмента.)</p>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td><b> Length (bytes)</b></td>
<td><b> Contents</b></td>
</tr>
<tr>
<td>00H</td>
<td align=center>2</td>
<td> Number of iterations of data</td>
</tr>
<tr>
<td>02H</td>
<td align=center>2</td>
<td> Number of bytes of data</td>
</tr>
<tr>
<td>04H</td>
<td align=center> n</td>
<td> Data</td>
</tr>
</table>
<p>Иначе, размер данных сегмента указан в поле length в таблице сегментов.<br>
<br>
Если сегмент описан в слове описания сегмента как
содержащий relocation information, то relocation table начинается
непосредственно после данных сегмента. Windows использует relocation table для
разрешения ссылок из сегмента на функции других
сегментов этого модуля и импортированных функций в
других модулях. (Смещения указаны от начала таблицы.)</p>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td><b> Length (bytes)</b></td>
<td><b> Contents</b></td>
</tr>
<tr>
<td>00H</td>
<td align=center>2</td>
<td> число элементов relocation длиной 8 байт каждый (см. ниже)</td>
</tr>
</table>
<br>
<table border=1 cellpadding=5 cellspacing=0>
<tr>
<td><b>Offset</b></td>
<td><b> Length (bytes)</b></td>
<td><b> Contents</b></td>
</tr>
<tr>
<td>00H</td>
<td align=center>1</td>
<td> Type of address to insert in segment:
<table border=0 cellpadding=5 cellspacing=0>
<tr>
<td>1</td>
<td> Offset only</td>
</tr>
<tr>
<td>2</td>
<td> Segment only</td>
</tr>
<tr>
<td>3</td>
<td> Segment and offset</td>
</tr>
</table>
</td>
</tr>
<tr>
<td>
01H</td>
<td align=center>1</td>
<td> Relocation type:
<table border=0 cellpadding=5 cellspacing=0>
<tr>
<td>0</td>
<td> Internal reference</td>
</tr>
<tr>
<td>1</td>
<td> Imported ordinal</td>
</tr>
<tr>
<td>2</td>
<td> Imported name</td>
</tr>
</table>
If bit 2 set, relocation type is additive (see below)
</td>
</tr>
<tr>
<td>
02H</td>
<td align=center>2</td>
<td> Offset of relocation item within segment
</td>
</tr>
<tr>
<td colspan="3">
Следующие 4 байта зависят от relocation type.</td>
</tr>
<tr>
<td colspan="3">
<i>Если это
внутренняя ссылка
на сегмент этого же модуля, то они трактуются, как описано ниже.
(Offsets are
from the beginning of the relocation item.)</i></td>
</tr>
<tr>
<td>
04H</td>
<td align=center>1</td>
<td> Segment number for fixed segment; 0FFH for movable segment
</td>
</tr>
<tr>
<td>
05H</td>
<td align=center>1</td>
<td> 0
</td>
</tr>
<tr>
<td>
06H</td>
<td align=center>2</td>
<td> If MOVABLE segment, ordinal number referenced in entry table; if FIXED
segment, offset into segment
</td>
</tr>
<tr>
<td colspan="3">
<i>
Если relocation type -это imported ordinal в дpугом модуле, то байты означают
следующее. (Offsets are from the beginning of the relocation item.)</i></td>
</tr>
<tr>
<td>
04H</td>
<td align=center>2</td>
<td> Index into module reference table
</td>
</tr>
<tr>
<td>
06H</td>
<td align=center>2</td>
<td> Function ordinal number
</td>
</tr>
<tr>
<td colspan="3">
<i>
Наконец, если relocation type суть imported name of a function in another
module, байты означают следующее. (Offsets are from the beginning of the
relocation item.)</i></td>
</tr>
<tr>
<td>
04H</td>
<td align=center>2</td>
<td> Index into module reference table
</td>
</tr>
<tr>
<td>
06H</td>
<td align=center>2</td>
<td> Offset within imported names table to
name of imported function
</td>
</tr>
</table>
<p>
Если флаг ADDITIVE в relocation type установлен, то адрес
внешней функции is
added к содержимому of the address in the target segment. Если флаг ADDITIVE
сброшен, то target contains an offset to another target within the same
segment that requires the same relocation address. This defines a chain of
target addresses that get the same address. The chain is terminated with a -1
entry.<br>
</p>
</body>
</html>
