box: debian
build:
  steps:
    - script:
        name: Install Tools
        code: apt-get update && apt-get install -y make nasm curl && rm -rf /var/lib/apt/lists/*
    - script:
        name: Compile OS
        code: make

deploy:
  #This is to deploy if the deploy target specified does not exist.
  steps:
    - github-create-release:
        token: $GITHUB_TOKEN
        tag: v1.0.0
    - github-upload-asset:
        token: $GITHUB_TOKEN
        file: build.tgz
        release_id: 1
  Nightly:
    - github-create-release:
        token: $GITHUB_TOKEN
        tag: v1.0.0
    - github-upload-asset:
        token: $GITHUB_TOKEN
        file: build.tgz
        release_id: 1
  Master:
    - github-create-release:
        token: $GITHUB_TOKEN
        tag: v1.0.0
    - github-upload-asset:
        token: $GITHUB_TOKEN
        file: build.tgz
        release_id: 1
  # notify slack on successful or failed deploys
  after-steps:
    - slack-notifier:
        url: $SLACK_URL
        channel: wercker
        username: werckerbot
        branch: nightly